*** Settings ***
Documentation   Testataan perustoiminnallisuudet
Suite Setup     Kipa Suite Setup
Suite Teardown  Stop Selenium Server
Test Setup      Open Competition
Test Teardown   Close Browser
Force Tags      regression  smoke
Library         SeleniumLibrary

*** Test Cases ***
Luodaan uusi kisa
    [Setup]  Open Kipa Main Page
    Create new Competition  ${TESTIKISA}

Tarkista syötä suorituksia
    Open Sub Page Verify Location And Title  syötä suorituksia  ${TULOSTEN_SYOTTO_URL}  ${TULOSTEN_SYOTTO_OTSIKKO}

Tarkista syötä suorituksia - tarkistus
    Open Sub Page Verify Location And Title  syötä suorituksia - tarkistus  ${TULOSTEN_SYOTTO_TARKISTUS_URL}  ${TULOSTEN_SYOTTO_TARKISTUS_OTSIKKO}

Tarkista tulossivu
    Open Sub Page Verify Location And Title  sarjan tulokset  ${TULOSTEN_TARKISTUS_URL}  ${TULOSTEN_TARKISTUS_OTSIKKO}

Tarkista Tuomarineuvosto
    Open Sub Page Verify Location And Title  tuomarineuvoston työkalu  ${TUOMARINEUVOSTO_URL}  ${TUOMARINEUVOSTO_OTSIKKO}
    Page Should Contain Button  Peruuta
    Page Should Contain Button  tallenna

Tarkista laskennan tilanne
    Open Sub Page Verify Location And Title  laskennan tilanne  ${LASKENNAN_TILANNE_URL}  ${LASKENNAN_TILANNE_OTSIKKO}

Tarkista vartioiden määritys
    Open Sub Page Verify Location And Title  määrittele vartiot  ${VARTIOIDEN_MAARITYS_URL}  ${VARTIOIDEN_MAARITYS_OTSIKKO}
    Page Should Contain Button  Peruuta
    Page Should Contain Button  tallenna

Tarkista tehtävien määritys
    Open Sub Page Verify Location And Title  määrittele tehtävät  ${TEHTAVAN_MAARITYS_URL}  ${TEHTAVAN_MAARITYS_OTSIKKO}

Tarkista Testituloksien määritys
    Open Sub Page Verify Location And Title  määrittele testituloksia  ${TESTITULOKSIEN_MAARITYS_URL}  ${TESTITULOKSIEN_MAARITYS_OTSIKKO}
    Page Should Contain Button  Peruuta
    Page Should Contain Button  tallenna

Tarkista palauta kisa
    Open Sub Page Verify Location And Title  palauta kisa  ${KISAN_TUONTI_URL}  ${KISAN_TUONTI_OTSIKKO}
    Page Should Contain Button  Peruuta
    Page Should Contain Button  tallenna
    Page Should Contain Element  file

Tarkista sarjan tulokset
    Open Sub Page Verify Location And Title  sarjan tulokset  ${TULOSTEN_TARKISTUS_URL}  ${TULOSTEN_TARKISTUS_OTSIKKO}
    Page Should Contain Link  Heijasta tuloksia

Lisätään sarjoja kisaan
    Click Link  määrittele kisan perustiedot
    Location Should Be  ${KIPA_URL}/${TESTIKISA}/${KISAN_MAARITYS_URL}/
    Title Should Be  Kipa - Määritä kisa
    Input Text  id_sarja_set-0-nimi  sininen
    Input Text  id_sarja_set-1-nimi  harmaa
    Click Button  tallenna
    Close Browser
    Open Competition
    Open Sub Page Verify Location And Title  määrittele vartiot  ${VARTIOIDEN_MAARITYS_URL}  ${VARTIOIDEN_MAARITYS_OTSIKKO}
    Page Should Contain Link  sininen
    Page Should Contain Link  harmaa

Poistetaan sarja kisasta
    Click Link  määrittele kisan perustiedot
    Location Should Be  ${KIPA_URL}/${TESTIKISA}/${KISAN_MAARITYS_URL}/
    comment  Valitaan eka chekboxi, sininen
    Select Checkbox  id_sarja_set-0-DELETE
    Click Button  tallenna
    Close Browser
    Open Competition
    Open Sub Page Verify Location And Title  määrittele vartiot  ${VARTIOIDEN_MAARITYS_URL}  ${VARTIOIDEN_MAARITYS_OTSIKKO}
    Page Should Contain Link  harmaa
    Page Should Not Contain Link  sininen

Poista Luotu Kisa
    Remove Competition  ${TESTIKISA}

*** Keywords ***
Open KiPa Main Page
    Open Browser And Maximize  ${KIPA_URL}/
    Maximize Browser Window
    Title Should Be  ${KIPA_OTSIKKO}

Create New Competition
    [Arguments]  ${competition}
    [Documentation]  Creates new competition and checks that it exist. Expects TESTIKISA to be given as argument.
    Click Link  Luo uusi kisa
    Location Should Be  ${KIPA_URL}/uusiKisa/${KISAN_MAARITYS_URL}/
    Input Text  id_nimi  ${competition}
    Click Button  tallenna
    Close Browser
    Open Browser And Maximize  ${KIPA_URL}/
    Click Link  ${competition}
    Location Should Be  ${KIPA_URL}/${competition}/
    Title Should Be  Kipa - ${competition}

Open Browser and Maximize
    [Arguments]  ${page}
    Open Browser  ${page}  ${BROWSER}
    Maximize Browser Window

Kipa Suite Setup
    Start Selenium Server
    Open Kipa Main Page
    Close Browser

Open Sub Page Verify Location And Title
    [Arguments]  ${link_name}  ${link}  ${page_title}
    Click Link  ${link_name}
    Location Should Be  ${KIPA_URL}/${TESTIKISA}/${link}/
    Title Should Be  ${page_title}

Open Competition
    Open KiPa Main Page
    Click Link  ${TESTIKISA}
    Title Should Be  Kipa - ${TESTIKISA}

Remove Competition
    [Arguments]  ${competition}
    Open KiPa Main Page
    click link  ${competition}
    title should be  Kipa - ${competition}
    Click Link  poista kisa
    Title Should Be  ${KISAN_POISTO_OTSIKKO}
    Click Button  Kyllä
    sleep  2 sec
    Title Should Be  ${KAIKKI_KISAT_OTSIKKO}
    Location Should Be  ${KIPA_URL}/
    Page Should Not Contain Link  ${competition}
    Page Should Not Contain  ${competition}

